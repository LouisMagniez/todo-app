<div class="search-task">
  <mat-form-field class="search-input">
    <div class="search">
      <input
        type="search"
        matInput
        placeholder="Search..."
        (ngModelChange)="(search.value)"
        #search
      />
      <mat-icon>search</mat-icon>
    </div>
  </mat-form-field>
</div>
<div class="chips">
  <mat-chip-listbox
    aria-label="chip-filter"
    [(ngModel)]="filterDoneStatus"
    (ngModelChange)="onChangeChipCheckUndefined()"
  >
    <mat-chip-option value="SEE_ALL" color="accent">See all</mat-chip-option>
    <mat-chip-option value="TO_DO" color="accent">To do</mat-chip-option>
    <mat-chip-option value="DONE" color="accent">Done</mat-chip-option>
  </mat-chip-listbox>
</div>
<div class="align-center">
  <mat-card class="task-card">
    <mat-card-content>
      <app-task-form (refreshTaskListEvent)="refreshTaskList()"></app-task-form>

      <mat-list-item
        *ngFor="
          let task of filterTaskList(search.value, filterDoneStatus);
          trackBy: trackById;
          last as last
        "
      >
        <div class="task">
          <div class="task-body">
            <mat-checkbox
              [disabled]="task.edit"
              [(ngModel)]="task.done"
              (ngModelChange)="onChangeDoneStatus(task)"
            ></mat-checkbox>
            <span
              [hidden]="task.edit"
              id="task{{ task.id }}"
              class="task-list"
              [ngClass]="{ 'task-done': task.done }"
            >
              {{ task.content }}
            </span>

            <app-task-edit
              [hidden]="!task.edit"
              [taskToEdit]="task"
            ></app-task-edit>
          </div>

          <div class="button-container">
            <div class="buttons">
              <button
                [hidden]="task.edit"
                mat-icon-button
                matTooltip="Edit"
                aria-label="Button to edit a task"
                (click)="onClickEdit(task)"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                [hidden]="task.edit"
                mat-icon-button
                matTooltip="Delete"
                aria-label="Button to delete a task"
                (click)="onClickDelete(task); refreshTaskList()"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>

        <div class="divider">
          <mat-divider *ngIf="!last"></mat-divider>
        </div>
      </mat-list-item>
    </mat-card-content>
    <mat-card-footer class="task-counter">
      <div class="counter-todo-done">
        <div>{{ taskCounter("TO_DO") }} Todo</div>
        <div>{{ taskCounter("DONE") }} Done</div>
      </div>

      <div class="counter-total">Total : {{ taskCounter("ALL") }}</div>
    </mat-card-footer>
  </mat-card>
</div>
